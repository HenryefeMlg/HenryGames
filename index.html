<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Henry Games</title>
    <style>
        :root {
            --primary-color: #4CAF50; /* Green */
            --primary-dark: #388E3C;
            --accent-color: #FFC107; /* Amber */
            --background-color: #F0F2F5;
            --text-color: #333;
            --light-text-color: #666;
            --border-color: #DDD;
            --shadow-color: rgba(0, 0, 0, 0.1);

            --spacing-xs: clamp(0.25rem, 1vw, 0.5rem);
            --spacing-sm: clamp(0.5rem, 2vw, 1rem);
            --spacing-md: clamp(1rem, 4vw, 1.5rem);
            --spacing-lg: clamp(1.5rem, 6vw, 2rem);
            --spacing-xl: clamp(2rem, 8vw, 3rem);

            --font-size-sm: clamp(0.8rem, 2vw, 1rem);
            --font-size-md: clamp(1rem, 2.5vw, 1.25rem);
            --font-size-lg: clamp(1.5rem, 4vw, 2rem);
            --font-size-xl: clamp(2rem, 5vw, 2.5rem);
            --font-size-xxl: clamp(3rem, 8vw, 4rem);

            --border-radius-sm: 8px;
            --border-radius-md: 12px;
        }

        body {
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
            overflow: hidden; /* Prevent body scroll when modal is open */
        }

        .app-container {
            background-color: white;
            border-radius: var(--border-radius-md);
            box-shadow: 0 var(--spacing-sm) var(--spacing-lg) var(--shadow-color);
            width: min(90vw, 1200px);
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            overflow-y: auto; /* Scroll content if it exceeds max-height */
            padding: var(--spacing-md);
            box-sizing: border-box;
            position: relative; /* For safe area padding */

            /* Safe area insets */
            padding-top: calc(var(--spacing-md) + env(safe-area-inset-top, 0px));
            padding-right: calc(var(--spacing-md) + env(safe-area-inset-right, 0px));
            padding-bottom: calc(var(--spacing-md) + env(safe-area-inset-bottom, 0px));
            padding-left: calc(var(--spacing-md) + env(safe-area-inset-left, 0px));
        }

        .header {
            font-size: var(--font-size-lg);
            font-weight: bold;
            color: var(--primary-dark);
            margin-bottom: var(--spacing-md);
            text-align: left;
            padding-bottom: var(--spacing-sm);
            border-bottom: 1px solid var(--border-color);
        }

        .section-title {
            font-size: var(--font-size-md);
            font-weight: bold;
            text-align: center;
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
            color: var(--light-text-color);
        }

        .date-input-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: var(--spacing-md);
            gap: var(--spacing-sm);
        }

        .date-input-label {
            font-size: var(--font-size-md);
            color: var(--text-color);
            font-weight: 500;
        }

        .custom-input {
            width: min(80%, 200px);
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            font-size: var(--font-size-md);
            text-align: center;
            cursor: pointer;
            background-color: #f9f9f9;
            transition: border-color 0.2s, box-shadow 0.2s;
            -webkit-tap-highlight-color: transparent; /* Remove tap highlight */
        }

        .custom-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.2);
        }

        .action-button {
            background-color: var(--primary-color);
            color: white;
            padding: var(--spacing-sm) var(--spacing-lg);
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: var(--font-size-md);
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.1s ease;
            margin-top: var(--spacing-md);
            -webkit-tap-highlight-color: transparent;
            min-height: 44px; /* Touch target size */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .action-button:hover {
            background-color: var(--primary-dark);
        }

        .action-button:active {
            transform: scale(0.98);
        }

        .emoji-output {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--spacing-md);
            margin-top: var(--spacing-xl);
            min-height: 100px; /* Ensure space even when empty */
        }

        .emoji {
            font-size: var(--font-size-xxl);
            line-height: 1;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Date Picker Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .modal-overlay.visible {
            opacity: 1;
            visibility: visible;
        }

        .date-picker-modal {
            background-color: white;
            border-radius: var(--border-radius-md);
            box-shadow: 0 var(--spacing-sm) var(--spacing-lg) var(--shadow-color);
            padding: var(--spacing-md);
            width: min(90vw, 350px);
            max-width: 400px;
            box-sizing: border-box;
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .modal-overlay.visible .date-picker-modal {
            transform: translateY(0);
        }

        .date-picker-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-md);
        }

        .date-picker-header button {
            background: none;
            border: none;
            font-size: var(--font-size-lg);
            cursor: pointer;
            color: var(--primary-color);
            padding: var(--spacing-xs);
            -webkit-tap-highlight-color: transparent;
            min-width: 44px;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .date-picker-header button:active {
            color: var(--primary-dark);
        }

        .date-picker-month-year {
            font-size: var(--font-size-md);
            font-weight: bold;
        }

        .date-picker-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: var(--spacing-xs);
            text-align: center;
        }

        .date-picker-grid span {
            font-size: var(--font-size-sm);
            font-weight: bold;
            color: var(--light-text-color);
            padding: var(--spacing-xs) 0;
        }

        .date-picker-grid button {
            background: none;
            border: none;
            font-size: var(--font-size-sm);
            padding: var(--spacing-xs) 0;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: background-color 0.2s, color 0.2s;
            -webkit-tap-highlight-color: transparent;
            min-width: 44px;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: auto; /* Center the button within its grid cell */
        }

        .date-picker-grid button:hover:not(.empty):not(.selected) {
            background-color: var(--background-color);
        }

        .date-picker-grid button.selected {
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
        }

        .date-picker-grid button.today {
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
        }

        .date-picker-grid button.empty {
            visibility: hidden;
            pointer-events: none;
        }

        /* Responsive adjustments */
        @media (max-width: 480px) {
            .app-container {
                padding: var(--spacing-lg);
                border-radius: 0; /* Full width on small phones */
                width: 100vw;
                max-height: 100vh;
            }
            .header {
                font-size: var(--font-size-lg);
            }
            .section-title {
                font-size: var(--font-size-md);
            }
            .custom-input, .action-button {
                width: 90%;
            }
            .emoji {
                font-size: var(--font-size-xxl);
            }
        }

        @media (min-width: 1025px) {
            .app-container {
                max-width: 800px; /* Limit width on very large screens */
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="header">Henry Games</div>

        <div class="date-input-container">
            <label for="selectedDateInput" class="date-input-label">Tarih Seçin:</label>
            <input type="text" id="selectedDateInput" class="custom-input" placeholder="Tarih Seç" readonly onclick="showDatePicker(this)">
        </div>

        <p class="section-title">Gelecekte sana olacaklar:</p>

        <button class="action-button" onclick="generateEmojis()">Geleceğini Gör! ✨</button>

        <div id="emojiOutput" class="emoji-output">
            <!-- Emojis will be displayed here -->
        </div>
    </div>

    <!-- Custom Date Picker Modal -->
    <div id="datePickerModalOverlay" class="modal-overlay">
        <div class="date-picker-modal">
            <div class="date-picker-header">
                <button onclick="changeMonth(-1)">◀️</button>
                <span id="currentMonthYear" class="date-picker-month-year"></span>
                <button onclick="changeMonth(1)">▶️</button>
            </div>
            <div id="datePickerGrid" class="date-picker-grid">
                <span>Pzt</span><span>Sal</span><span>Çar</span><span>Per</span><span>Cum</span><span>Cmt</span><span>Paz</span>
                <!-- Calendar days will be rendered here -->
            </div>
        </div>
    </div>

    <script>
        const APP_STORAGE_KEY = 'HENRY_GAMES_APP_STORAGE_KEY';
        window.APP_STORAGE_KEY = APP_STORAGE_KEY;

        document.addEventListener("focusin", function(e) {
            if (e.target.tagName === "INPUT" && e.target.type !== "text") {
                setTimeout(() => e.target.blur(), 100);
            }
        });

        document.body.addEventListener('dblclick', function(event) {
            event.preventDefault();
        });

        const dateInput = document.getElementById('selectedDateInput');
        const datePickerModalOverlay = document.getElementById('datePickerModalOverlay');
        const currentMonthYearSpan = document.getElementById('currentMonthYear');
        const datePickerGrid = document.getElementById('datePickerGrid');

        let currentDatePickerDate = new Date();
        let targetDateInput = null;

        function showDatePicker(input) {
            targetDateInput = input;
            input.blur();
            document.activeElement.blur();

            if (input.value) {
                const parts = input.value.split('.');
                if (parts.length === 3) {
                    currentDatePickerDate = new Date(parseInt(parts[2]), parseInt(parts[1]) - 1, parseInt(parts[0]));
                } else {
                    currentDatePickerDate = new Date();
                }
            } else {
                currentDatePickerDate = new Date();
            }

            renderCalendar(currentDatePickerDate.getMonth(), currentDatePickerDate.getFullYear());
            datePickerModalOverlay.classList.add('visible');
        }

        function hideDatePicker() {
            datePickerModalOverlay.classList.remove('visible');
            targetDateInput = null;
            if (dateInput) {
                dateInput.blur();
            }
            document.activeElement.blur();
        }

        datePickerModalOverlay.addEventListener('click', (e) => {
            if (e.target === datePickerModalOverlay) {
                hideDatePicker();
            }
        });

        function renderCalendar(month, year) {
            datePickerGrid.innerHTML = '<span>Pzt</span><span>Sal</span><span>Çar</span><span>Per</span><span>Cum</span><span>Cmt</span><span>Paz</span>';
            currentMonthYearSpan.textContent = new Date(year, month).toLocaleString('tr-TR', { month: 'long', year: 'numeric' });

            const firstDayOfMonth = new Date(year, month, 1);
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            let startDay = firstDayOfMonth.getDay();
            if (startDay === 0) startDay = 7;
            startDay = startDay - 1;

            for (let i = 0; i < startDay; i++) {
                const emptyCell = document.createElement('button');
                emptyCell.classList.add('empty');
                datePickerGrid.appendChild(emptyCell);
            }

            const today = new Date();
            const selectedDate = targetDateInput && targetDateInput.value ? parseDateString(targetDateInput.value) : null;

            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month, day);
                const button = document.createElement('button');
                button.textContent = day;
                button.onclick = () => selectDate(day, month, year);

                if (date.toDateString() === today.toDateString()) {
                    button.classList.add('today');
                }
                if (selectedDate && date.toDateString() === selectedDate.toDateString()) {
                    button.classList.add('selected');
                }
                datePickerGrid.appendChild(button);
            }
        }

        function changeMonth(offset) {
            currentDatePickerDate.setMonth(currentDatePickerDate.getMonth() + offset);
            renderCalendar(currentDatePickerDate.getMonth(), currentDatePickerDate.getFullYear());
        }

        function selectDate(day, month, year) {
            const selected = new Date(year, month, day);
            const formattedDate = selected.toLocaleDateString('tr-TR', { day: '2-digit', month: '2-digit', year: 'numeric' });
            if (targetDateInput) {
                targetDateInput.value = formattedDate;
            }
            hideDatePicker();
            saveData();
        }

        function parseDateString(dateString) {
            const parts = dateString.split('.');
            if (parts.length === 3) {
                return new Date(parseInt(parts[2]), parseInt(parts[1]) - 1, parseInt(parts[0]));
            }
            return null;
        }

        const possibleEmojis = [
            '😀', '🌟', '🍀', '🚀', '💰', '❤️', '💡', '🎉', '🌈', '🏆',
            '🏡', '✈️', '💍', '👶', '🎓', '📈', '🧘', '🎶', '📚', '🗺️',
            '🤝', '🥳', '🎁', '☀️', '🌊', '🌳', '🐱', '🐶', '🍕', '☕'
        ];
        const emojiOutputDiv = document.getElementById('emojiOutput');

        function generateEmojis() {
            emojiOutputDiv.innerHTML = '';
            const generated = [];
            for (let i = 0; i < 3; i++) {
                const randomIndex = Math.floor(Math.random() * possibleEmojis.length);
                const emoji = possibleEmojis[randomIndex];
                generated.push(emoji);

                const emojiSpan = document.createElement('span');
                emojiSpan.classList.add('emoji');
                emojiSpan.textContent = emoji;
                emojiOutputDiv.appendChild(emojiSpan);
            }
            saveData(generated);
        }

        function saveData(emojis = null) {
            const data = {
                lastSelectedDate: dateInput.value,
                lastGeneratedEmojis: emojis || (emojiOutputDiv.children.length > 0 ? Array.from(emojiOutputDiv.children).map(span => span.textContent) : [])
            };
            localStorage.setItem(APP_STORAGE_KEY + '_data', JSON.stringify(data));
        }

        function loadData() {
            const saved = localStorage.getItem(APP_STORAGE_KEY + '_data');
            if (saved) {
                const data = JSON.parse(saved);
                if (data.lastSelectedDate) {
                    dateInput.value = data.lastSelectedDate;
                }
                if (data.lastGeneratedEmojis && data.lastGeneratedEmojis.length > 0) {
                    emojiOutputDiv.innerHTML = '';
                    data.lastGeneratedEmojis.forEach(emoji => {
                        const emojiSpan = document.createElement('span');
                        emojiSpan.classList.add('emoji');
                        emojiSpan.textContent = emoji;
                        emojiOutputDiv.appendChild(emojiSpan);
                    });
                }
            }
        }

        window.addEventListener('load', loadData);
    </script>
</body>
</html>
